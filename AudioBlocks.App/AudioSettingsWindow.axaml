<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="AudioBlocks.App.AudioSettingsWindow"
        Title="Audio Settings"
        Width="680" Height="640"
        Background="{DynamicResource AppBg}"
        WindowStartupLocation="CenterOwner">

  <Window.Styles>
    <Style Selector="Border.card">
      <Setter Property="Background" Value="{DynamicResource CardBg}"/>
      <Setter Property="CornerRadius" Value="8"/>
      <Setter Property="Padding" Value="14"/>
      <Setter Property="Margin" Value="0,4"/>
    </Style>
    <Style Selector="TextBlock.label">
      <Setter Property="Foreground" Value="{DynamicResource MutedText}"/>
      <Setter Property="FontSize" Value="12"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="Margin" Value="0,0,0,3"/>
    </Style>
  </Window.Styles>

  <ScrollViewer VerticalScrollBarVisibility="Auto">
    <StackPanel Margin="16" Spacing="10">
      <TextBlock Text="Audio Settings" FontSize="18" FontWeight="Bold" Foreground="{DynamicResource FgText}"/>

      <!-- THEME -->
      <Border Classes="card">
        <StackPanel Spacing="6">
          <TextBlock Text="Appearance" FontWeight="SemiBold" Foreground="{DynamicResource FgText}"/>
          <StackPanel Orientation="Horizontal" Spacing="8">
            <TextBlock Text="Theme" VerticalAlignment="Center" Foreground="{DynamicResource MutedText}" FontSize="12"/>
            <ComboBox x:Name="ThemeComboBox" Width="140">
              <ComboBoxItem Content="Dark"/>
              <ComboBoxItem Content="Light"/>
            </ComboBox>
          </StackPanel>
        </StackPanel>
      </Border>

      <!-- DRIVER + PARAMS -->
      <Border Classes="card">
        <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="16" RowSpacing="10">

          <StackPanel Grid.Column="0" Grid.Row="0">
            <TextBlock Classes="label" Text="Audio Driver"/>
            <ComboBox x:Name="DriverComboBox" HorizontalAlignment="Stretch">
              <ComboBoxItem Content="WASAPI Shared"/>
              <ComboBoxItem Content="WASAPI Exclusive"/>
              <ComboBoxItem Content="ASIO"/>
            </ComboBox>
          </StackPanel>

          <StackPanel Grid.Column="1" Grid.Row="0">
            <TextBlock Classes="label" Text="Sample Rate"/>
            <ComboBox x:Name="SampleRateComboBox" HorizontalAlignment="Stretch">
              <ComboBoxItem Content="44100"/>
              <ComboBoxItem Content="48000"/>
              <ComboBoxItem Content="96000"/>
            </ComboBox>
          </StackPanel>

          <StackPanel Grid.Column="0" Grid.Row="1">
            <TextBlock Classes="label" Text="ASIO Driver"/>
            <ComboBox x:Name="AsioDriverComboBox" HorizontalAlignment="Stretch"/>
          </StackPanel>

          <StackPanel Grid.Column="1" Grid.Row="1">
            <TextBlock Classes="label" Text="Buffer Size"/>
            <ComboBox x:Name="BufferSizeComboBox" HorizontalAlignment="Stretch">
              <ComboBoxItem Content="64"/>
              <ComboBoxItem Content="128"/>
              <ComboBoxItem Content="256"/>
              <ComboBoxItem Content="512"/>
            </ComboBox>
          </StackPanel>

          <StackPanel Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="2">
            <TextBlock x:Name="DriverNoteText" Foreground="{DynamicResource DimText}" FontSize="11" FontStyle="Italic" TextWrapping="Wrap"/>
          </StackPanel>
        </Grid>
      </Border>

      <!-- WASAPI DEVICES -->
      <Border Classes="card">
        <StackPanel Spacing="8">
          <TextBlock Text="WASAPI Devices" FontWeight="SemiBold" Foreground="{DynamicResource FgText}"/>
          <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
            <StackPanel Grid.Column="0">
              <TextBlock Classes="label" Text="Input Device"/>
              <ComboBox x:Name="InputDeviceComboBox" HorizontalAlignment="Stretch"/>
            </StackPanel>
            <StackPanel Grid.Column="1">
              <TextBlock Classes="label" Text="Output Device"/>
              <ComboBox x:Name="OutputDeviceComboBox" HorizontalAlignment="Stretch"/>
            </StackPanel>
          </Grid>
        </StackPanel>
      </Border>

      <!-- ASIO MAPPING -->
      <Border Classes="card">
        <StackPanel Spacing="8">
          <TextBlock Text="ASIO Channel Mapping" FontWeight="SemiBold" Foreground="{DynamicResource FgText}"/>
          <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
            <StackPanel Grid.Column="0" Spacing="4">
              <TextBlock Classes="label" Text="Input L / R"/>
              <StackPanel Orientation="Horizontal" Spacing="6">
                <ComboBox x:Name="AsioInLeftComboBox" Width="110"/>
                <ComboBox x:Name="AsioInRightComboBox" Width="110"/>
              </StackPanel>
            </StackPanel>
            <StackPanel Grid.Column="1" Spacing="4">
              <TextBlock Classes="label" Text="Output L / R"/>
              <StackPanel Orientation="Horizontal" Spacing="6">
                <ComboBox x:Name="AsioOutLeftComboBox" Width="110"/>
                <ComboBox x:Name="AsioOutRightComboBox" Width="110"/>
              </StackPanel>
            </StackPanel>
          </Grid>
          <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,6,0,0">
            <Button x:Name="OpenAsioControlPanelButton" Content="ASIO Control Panel" Height="30"/>
            <Button x:Name="TestRoutingButton" Content="Test Routing" Height="30"/>
          </StackPanel>
        </StackPanel>
      </Border>

      <!-- METERS -->
      <Border Classes="card">
        <StackPanel Spacing="6">
          <Grid ColumnDefinitions="*,Auto">
            <TextBlock Text="Monitoring" FontWeight="SemiBold" Foreground="{DynamicResource FgText}"/>
            <TextBlock x:Name="ProcessingLabel" Text="0.00 ms" Foreground="{DynamicResource DimText}" FontSize="11" Grid.Column="1"/>
          </Grid>
          <ProgressBar x:Name="VuMeter" Minimum="0" Maximum="1" Height="18"/>
          <StackPanel Orientation="Horizontal" Spacing="14">
            <TextBlock x:Name="LatencyLabel" Text="—" Foreground="{DynamicResource FgText}" FontSize="12"/>
            <TextBlock x:Name="CpuWarningLabel" Text="" Foreground="#FF6B6B" FontWeight="Bold" FontSize="12"/>
          </StackPanel>
        </StackPanel>
      </Border>

      <!-- ACTIONS -->
      <StackPanel Orientation="Horizontal" Spacing="8">
        <Button x:Name="ApplyButton" Content="Apply &amp; Start" Height="36" Background="{DynamicResource AccentBrush}" Foreground="White" FontWeight="Bold"/>
        <Button x:Name="StartSineButton" Content="Start Sine" Height="36"/>
        <Button x:Name="StopSineButton" Content="Stop Sine" Height="36"/>
      </StackPanel>

      <!-- LOGS -->
      <Border Classes="card">
        <StackPanel Spacing="4">
          <TextBlock Text="Log" FontWeight="SemiBold" Foreground="{DynamicResource FgText}"/>
          <TextBox x:Name="StatusLabel" IsReadOnly="True" AcceptsReturn="True" TextWrapping="Wrap"
                   Height="120" Background="{DynamicResource SurfaceBg}" Foreground="{DynamicResource MutedText}" FontSize="11"/>
        </StackPanel>
      </Border>

    </StackPanel>
  </ScrollViewer>
</Window>